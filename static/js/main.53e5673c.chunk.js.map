{"version":3,"sources":["assets/pushpin-2-fill.svg","assets/alarm-warning-fill.svg","assets/fire-fill.svg","assets/first-aid-kit-fill.svg","assets/broadcast-fill.svg","assets/focus-3-line.svg","api/index.js","components/MapView.js","actions/mapActions.js","actions/types.js","components/TopSheet.js","components/LoadingPanel.js","components/BottomSheet.js","components/App.js","reducers/eventsReducer.js","reducers/mapReducer.js","reducers/preferencesReducer.js","reducers/index.js","serviceWorker.js","index.js"],"names":["module","exports","axios","create","baseURL","Mapbox","ReactMapboxGl","accessToken","pinIcon","Image","src","pinAsset","policeIcon","policeAsset","fireIcon","fireAsset","medicalIcon","medicalAsset","infoIcon","infoAsset","positionIcon","positionAsset","MAP_DEFAULTS","defaultZoom","volumetricPainter","type","property","data","eventId","eventType","userToken","eventDesc","coordinates","lat","lon","reportedDt","confirms","dismisses","connect","state","preferences","marker","map","setMarkerPosition","console","log","payload","center","onMoveEnd","toggleControls","history","useHistory","useWindowSize","width","height","showVolumetricBuildings","onItemHover","showBasicMapFeatures","cursor","getCanvas","style","handleItemClick","useCallback","feature","originalEvent","preventDefault","push","properties","onMouseEvents","useMemo","onMouseEnter","event","onMouseLeave","onClick","zoom","containerStyle","onStyleLoad","on","defaultPrevented","mapEvent","stopPropagation","onContextMenu","lngLat","lng","id","sourceId","sourceLayer","filter","minZoom","paint","layout","evt","key","TopSheet","visible","useState","query","setQuery","Sidebar","as","Segment","inverted","raised","direction","animation","textAlign","Search","value","onSearchChange","open","LoadingPanel","padding","paddingBottom","minHeight","display","alignItems","Loader","active","inline","EventList","React","lazy","EventDetails","EventSubmit","withRouter","className","exact","path","fallback","events","currentPosition","setCurrentPosition","location","useGeolocation","enableHighAccuracy","maximumAge","timeout","useEffect","loading","longitude","latitude","controlsVisible","setControlsVisible","url","useLocation","menuItems","name","pathname","Pushable","Pusher","defaultPosition","position","getCenter","v","Menu","pointing","fixed","size","widths","onItemClick","items","INITIAL_STATE","dangerClose","nearbyEvents","JSON","parse","localStorage","getItem","eventFilter","rootReducer","combineReducers","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","applyMiddleware","thunk","Boolean","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.53e5673c.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/pushpin-2-fill.ee14c364.svg\";","module.exports = __webpack_public_path__ + \"static/media/alarm-warning-fill.672b5640.svg\";","module.exports = __webpack_public_path__ + \"static/media/fire-fill.3ef6087f.svg\";","module.exports = __webpack_public_path__ + \"static/media/first-aid-kit-fill.df4d90db.svg\";","module.exports = __webpack_public_path__ + \"static/media/broadcast-fill.9172578d.svg\";","module.exports = __webpack_public_path__ + \"static/media/focus-3-line.54eac840.svg\";","import axios from \"axios\";\r\n\r\nconst API = axios.create({\r\n  baseURL: \"\",\r\n});\r\n\r\nexport default API;\r\n","import React, { useMemo, useCallback } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { useWindowSize } from \"react-use\";\r\nimport ReactMapboxGl, {\r\n  Layer,\r\n  Feature,\r\n  Popup,\r\n  Image as Pin,\r\n} from \"react-mapbox-gl\";\r\n\r\nimport { setMarkerPosition } from \"../actions\";\r\nimport pinAsset from \"../assets/pushpin-2-fill.svg\";\r\nimport policeAsset from \"../assets/alarm-warning-fill.svg\";\r\nimport fireAsset from \"../assets/fire-fill.svg\";\r\nimport medicalAsset from \"../assets/first-aid-kit-fill.svg\";\r\nimport infoAsset from \"../assets/broadcast-fill.svg\";\r\nimport positionAsset from \"../assets/focus-3-line.svg\";\r\n\r\nconst Mapbox = ReactMapboxGl({\r\n  accessToken:\r\n    \"pk.eyJ1IjoicmVrdGRlY2thcmQiLCJhIjoiY2theWJ4OXM0MGhiejJ3cnkzcmk0andiYyJ9.IinlG0vyUvcWhvlAREJXeA\",\r\n});\r\n\r\nconst pinIcon = new Image(24, 24);\r\npinIcon.src = pinAsset;\r\nconst policeIcon = new Image(24, 24);\r\npoliceIcon.src = policeAsset;\r\nconst fireIcon = new Image(24, 24);\r\nfireIcon.src = fireAsset;\r\nconst medicalIcon = new Image(24, 24);\r\nmedicalIcon.src = medicalAsset;\r\nconst infoIcon = new Image(24, 24);\r\ninfoIcon.src = infoAsset;\r\nconst positionIcon = new Image(24, 24);\r\npositionIcon.src = positionAsset;\r\n\r\nconst MAP_DEFAULTS = {\r\n  defaultZoom: [10],\r\n  volumetricPainter: {\r\n    \"fill-extrusion-color\": \"#424d5c\",\r\n    \"fill-extrusion-height\": {\r\n      type: \"identity\",\r\n      property: \"height\",\r\n    },\r\n    \"fill-extrusion-base\": {\r\n      type: \"identity\",\r\n      property: \"min_height\",\r\n    },\r\n    \"fill-extrusion-opacity\": 0.6,\r\n  },\r\n};\r\n\r\nconst data = [\r\n  {\r\n    eventId: \"3A4221E1-9AD7-4296-863D-3B8F56E092C7\",\r\n    eventType: \"Riots\",\r\n    userToken: \"123423\",\r\n    eventDesc: \"Example Riot Event\",\r\n    coordinates: { lat: 40.73663, lon: -73.99973 },\r\n    reportedDt: \"12345\",\r\n    confirms: 0,\r\n    dismisses: 0,\r\n  },\r\n];\r\n\r\nconst i2 = <img src=\"../assets/map-pin-2-fill.svg\" />;\r\n\r\nconst MapView = ({\r\n  center,\r\n  onMoveEnd,\r\n  toggleControls,\r\n  preferences,\r\n  marker,\r\n  setMarkerPosition,\r\n}) => {\r\n  const history = useHistory();\r\n  const { width, height } = useWindowSize();\r\n  const { showVolumetricBuildings, showBasicMapFeatures } = preferences;\r\n\r\n  const initializeMap = (map, event) => {\r\n    console.log(event)\r\n    map.on(\"click\", ({ originalEvent }) => {\r\n      if (!originalEvent.defaultPrevented) {\r\n        toggleControls();\r\n        history.push(\"/\");\r\n      }\r\n    });\r\n    // map.on(\"move\", ({ originalEvent }) => originalEvent.preventDefault())\r\n  };\r\n\r\n  const onItemHover = ({ map }, cursor) => {\r\n    map.getCanvas().style.cursor = cursor;\r\n  };\r\n\r\n  const handleItemClick = useCallback(\r\n    ({ feature, originalEvent }) => {\r\n      originalEvent.preventDefault();\r\n      toggleControls(true);\r\n      history.push(`/events/${feature.properties.eventId}`);\r\n    },\r\n    [history, toggleControls]\r\n  );\r\n\r\n  const onMouseEvents = useMemo(\r\n    () => ({\r\n      onMouseEnter: (event) => onItemHover(event, \"pointer\"),\r\n      onMouseLeave: (event) => onItemHover(event, \"\"),\r\n      onClick: handleItemClick,\r\n    }),\r\n    [handleItemClick]\r\n  );\r\n\r\n  const handleAddMarker = (map, mapEvent) => {\r\n    const { lat, lng } = mapEvent.lngLat;\r\n    toggleControls(true);\r\n    setMarkerPosition([lng, lat]);\r\n    history.push(\"/submit\");\r\n  };\r\n\r\n  const handleMapDragged = (map, mapEvent) => {\r\n    console.log(mapEvent.originalEvent);\r\n    /* eslint-disable no-unused-expressions */\r\n    mapEvent.originalEvent?.stopPropagation?.(); \r\n    onMoveEnd(map);\r\n  }\r\n\r\n  return (\r\n    <div style={{ width, height }}>\r\n      <Mapbox\r\n        style=\"mapbox://styles/rektdeckard/ckayd52rb0xzg1imcbyek0g4y\"\r\n        center={center}\r\n        zoom={MAP_DEFAULTS.defaultZoom}\r\n        containerStyle={{\r\n          height: \"100%\",\r\n          width: \"100%\",\r\n        }}\r\n        onStyleLoad={initializeMap}\r\n        onMoveEnd={handleMapDragged}\r\n        onContextMenu={handleAddMarker}\r\n      >\r\n        <Pin id=\"police\" data={policeIcon} />\r\n        <Pin id=\"pin\" data={pinIcon} />\r\n        <Pin id=\"fire\" data={fireIcon} />\r\n        <Pin id=\"medical\" data={medicalIcon} />\r\n        <Pin id=\"info\" data={infoIcon} />\r\n        <Pin id=\"position\" data={positionIcon} />\r\n\r\n        {showVolumetricBuildings && (\r\n          <Layer\r\n            id=\"3d-buildings\"\r\n            type=\"fill-extrusion\"\r\n            sourceId=\"composite\"\r\n            sourceLayer=\"building\"\r\n            filter={[\"==\", \"extrude\", \"true\"]}\r\n            minZoom={14}\r\n            paint={MAP_DEFAULTS.volumetricPainter}\r\n          />\r\n        )}\r\n        {marker && (\r\n          <Layer\r\n            id=\"map-marker\"\r\n            type=\"symbol\"\r\n            layout={{\r\n              \"icon-image\": \"pin\",\r\n              \"icon-anchor\": \"bottom\",\r\n              \"icon-allow-overlap\": true,\r\n            }}\r\n          >\r\n            <Feature coordinates={marker} />\r\n          </Layer>\r\n        )}\r\n        <Layer\r\n          id=\"event-markers\"\r\n          type=\"symbol\"\r\n          layout={{ \"icon-image\": \"info\", \"icon-allow-overlap\": true }}\r\n          // images={[\"test\", image]}\r\n        >\r\n          {data.map((evt) => {\r\n            const {\r\n              eventId,\r\n              coordinates: { lon, lat },\r\n            } = evt;\r\n            return (\r\n              <Feature\r\n                key={eventId}\r\n                coordinates={[lon, lat]}\r\n                properties={evt}\r\n                {...onMouseEvents}\r\n              />\r\n            );\r\n          })}\r\n        </Layer>\r\n        <Layer\r\n          id=\"location-marker\"\r\n          type=\"symbol\"\r\n          layout={{ \"icon-image\": \"position\", \"icon-allow-overlap\": true }}\r\n        >\r\n          <Feature\r\n            coordinates={center}\r\n            properties={{ coordinates: center }}\r\n            {...onMouseEvents}\r\n          />\r\n        </Layer>\r\n      </Mapbox>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n  return { preferences: state.preferences, marker: state.map.marker };\r\n};\r\n\r\nexport default connect(mapStateToProps, { setMarkerPosition })(MapView);\r\n","import { SET_MARKER_POSITION } from \".\";\r\n\r\nexport const setMarkerPosition = (coordinates) => {\r\n  console.log(coordinates);\r\n  return {\r\n    type: SET_MARKER_POSITION,\r\n    payload: coordinates,\r\n  };\r\n};\r\n","export const FETCH_EVENTS = \"fetch_events\";\r\nexport const FETCH_EVENT_DETAILS = \"fetch_event_details\";\r\nexport const UPDATE_EVENT = \"update_event\";\r\n\r\nexport const SET_EVENT_FILTER = \"update_event_filter\";\r\nexport const SET_DEFAULT_POSITION = \"update_default_position\";\r\n\r\nexport const SET_MARKER_POSITION = \"set_marker_position\";\r\n","import React, { useState } from \"react\";\r\nimport { Segment, Search, Sidebar, Input } from \"semantic-ui-react\";\r\n\r\nconst TopSheet = ({ visible }) => {\r\n  const [query, setQuery] = useState(\"\");\r\n\r\n  return (\r\n    <Sidebar\r\n      as={Segment}\r\n      inverted\r\n      raised\r\n      direction=\"top\"\r\n      animation=\"push\"\r\n      textAlign=\"center\"\r\n      visible={visible}\r\n    >\r\n      {/* <Input\r\n      fluid\r\n      icon=\"search\"\r\n      placeholder=\"Search...\"\r\n      value={query}\r\n      onChange={(event, { value }) => setQuery(value)}\r\n    /> */}\r\n      <Search\r\n        value={query}\r\n        onSearchChange={(event, { value }) => setQuery(value)}\r\n        open={false}\r\n      />\r\n    </Sidebar>\r\n  );\r\n};\r\n\r\nexport default TopSheet;\r\n","import React from \"react\";\r\nimport { Segment, Loader } from \"semantic-ui-react\";\r\n\r\nconst LoadingPanel = () => (\r\n  <Segment raised inverted style={{ padding: 8, paddingBottom: 44 }}>\r\n    <div style={{ minHeight: 200, display: \"flex\", alignItems: \"center\" }}>\r\n      <Loader active inline=\"centered\" />\r\n    </div>\r\n  </Segment>\r\n);\r\n\r\nexport default LoadingPanel;\r\n","import React, { Suspense } from \"react\";\r\nimport { withRouter, Switch, Route } from \"react-router-dom\";\r\nimport { Sidebar } from \"semantic-ui-react\";\r\n\r\nimport LoadingPanel from \"./LoadingPanel\";\r\n\r\nconst EventList = React.lazy(() => import(\"./EventList\"));\r\nconst EventDetails = React.lazy(() => import(\"./EventDetails\"));\r\nconst EventSubmit = React.lazy(() => import(\"./EventSubmit\"));\r\nconst Loader = <LoadingPanel />;\r\n\r\nconst BottomSheet = ({ visible }) => {\r\n  return (\r\n    <Sidebar\r\n      className=\"no-overflow\"\r\n      animation=\"push\"\r\n      direction=\"bottom\"\r\n      visible={visible}\r\n    >\r\n      <Switch>\r\n        <Route exact path=\"/events\">\r\n          <Suspense fallback={Loader}>\r\n            <EventList />\r\n          </Suspense>\r\n        </Route>\r\n        <Route path=\"/events/:id\">\r\n          <Suspense fallback={Loader}>\r\n            <EventDetails />\r\n          </Suspense>\r\n        </Route>\r\n        <Route exact path=\"/submit\">\r\n          <Suspense fallback={Loader}>\r\n            <EventSubmit />\r\n          </Suspense>\r\n        </Route>\r\n        <Route exact path=\"/report\">\r\n          <LoadingPanel />\r\n        </Route>\r\n        <Route exact path=\"/sos\">\r\n          <LoadingPanel />\r\n        </Route>\r\n      </Switch>\r\n    </Sidebar>\r\n  );\r\n};\r\n\r\nexport default withRouter(BottomSheet);\r\n","import React, { useState, useMemo, useEffect } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { useLocation, useHistory } from \"react-router-dom\";\r\nimport { useGeolocation } from \"react-use\";\r\nimport { Header, Icon, Image, Menu, Segment, Sidebar } from \"semantic-ui-react\";\r\n\r\nimport MapView from \"./MapView\";\r\nimport TopSheet from \"./TopSheet\";\r\nimport BottomSheet from \"./BottomSheet\";\r\n\r\nconst App = ({ events, preferences }) => {\r\n  const [currentPosition, setCurrentPosition] = useState(null);\r\n  const location = useGeolocation({\r\n    enableHighAccuracy: false,\r\n    maximumAge: 15000,\r\n    timeout: 30000,\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (!location.loading && location.longitude) {\r\n      setCurrentPosition([location.longitude, location.latitude]);\r\n    }\r\n  }, [location]);\r\n\r\n  const [controlsVisible, setControlsVisible] = useState(true);\r\n  const url = useLocation();\r\n  const history = useHistory();\r\n  const menuItems = useMemo(\r\n    () => [\r\n      {\r\n        key: \"nearby\",\r\n        name: \"Nearby\",\r\n        path: \"/events\",\r\n        active: url.pathname === \"/events\",\r\n      },\r\n      {\r\n        key: \"report\",\r\n        name: \"Report\",\r\n        path: \"/report\",\r\n        active: url.pathname === \"/report\",\r\n      },\r\n      {\r\n        key: \"sos\",\r\n        name: \"SOS\",\r\n        path: \"/sos\",\r\n        active: url.pathname === \"/sos\",\r\n      },\r\n    ],\r\n    [url]\r\n  );\r\n\r\n  const handleMenuItemClick = (event, data) => {\r\n    const { path } = data;\r\n    setControlsVisible(true);\r\n    history.push(path);\r\n  };\r\n\r\n  const handleMapMove = (mapEvent) => {\r\n    const { lng: lon, lat } = mapEvent.getCenter();\r\n    // setMapPosition([lon, lat]);\r\n  };\r\n\r\n  const handleMapContextMenu = (mapEvent) => {\r\n    console.log(mapEvent);\r\n  };\r\n\r\n  const handleToggleControls = (visible) => {\r\n    if (typeof visible === \"boolean\") return setControlsVisible(visible);\r\n    setControlsVisible((v) => !v);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Sidebar.Pushable className=\"no-overflow\">\r\n        <TopSheet visible={controlsVisible} />\r\n        <BottomSheet visible={controlsVisible} />\r\n        <Sidebar.Pusher>\r\n          <MapView\r\n            center={currentPosition ?? preferences.defaultPosition}\r\n            position={currentPosition}\r\n            onMoveEnd={handleMapMove}\r\n            toggleControls={handleToggleControls}\r\n            onContextMenu={handleMapContextMenu}\r\n          />\r\n        </Sidebar.Pusher>\r\n      </Sidebar.Pushable>\r\n      <Menu\r\n        pointing\r\n        inverted\r\n        fixed=\"bottom\"\r\n        size=\"large\"\r\n        widths={3}\r\n        onItemClick={handleMenuItemClick}\r\n        items={menuItems}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    events: state.events,\r\n    preferences: state.preferences,\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, {})(App);\r\n","import { FETCH_EVENTS, FETCH_EVENT_DETAILS, UPDATE_EVENT } from \"../actions\";\r\n\r\nconst INITIAL_STATE = {\r\n  dangerClose: false,\r\n  nearbyEvents: [],\r\n};\r\n\r\nexport default (state = INITIAL_STATE, { type, payload }) => {\r\n  switch (type) {\r\n    case FETCH_EVENTS:\r\n      return {\r\n        ...state,\r\n        nearbyEvents: payload,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { SET_MARKER_POSITION } from \"../actions\";\r\n\r\nconst INITIAL_STATE = {\r\n  marker: null,\r\n};\r\n\r\nexport default (state = INITIAL_STATE, { type, payload }) => {\r\n  switch (type) {\r\n    case SET_MARKER_POSITION:\r\n      return {\r\n        ...state,\r\n        marker: payload,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { SET_DEFAULT_POSITION, SET_EVENT_FILTER } from \"../actions\";\r\n\r\nconst INITIAL_STATE = {\r\n  defaultPosition: JSON.parse(localStorage.getItem(SET_DEFAULT_POSITION)) ?? [\r\n    -74.0,\r\n    40.73,\r\n  ],\r\n  eventFilter: [],\r\n  showBasicMapFeatures: true,\r\n  showVolumetricBuildings: true,\r\n};\r\n\r\nexport default (state = INITIAL_STATE, { type, payload }) => {\r\n  switch (type) {\r\n    case SET_DEFAULT_POSITION:\r\n      return {\r\n        ...state,\r\n        defaultPosition: payload,\r\n      };\r\n    case SET_EVENT_FILTER:\r\n      return {\r\n        ...state,\r\n        eventFilter: payload,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { combineReducers, createStore, applyMiddleware, compose } from \"redux\";\r\nimport thunk from \"redux-thunk\";\r\n\r\nimport eventsReducer from \"./eventsReducer\";\r\nimport mapReducer from \"./mapReducer\";\r\nimport preferencesReducer from \"./preferencesReducer\";\r\n\r\nconst rootReducer = combineReducers({\r\n  events: eventsReducer,\r\n  map: mapReducer,\r\n  preferences: preferencesReducer,\r\n});\r\n\r\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\nconst store = createStore(\r\n  rootReducer,\r\n  {},\r\n  composeEnhancers(applyMiddleware(thunk))\r\n);\r\n\r\nexport default store;\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { Provider } from \"react-redux\";\nimport { BrowserRouter as Router } from \"react-router-dom\";\nimport \"semantic-ui-css/semantic.min.css\";\nimport \"remixicon/fonts/remixicon.css\";\nimport \"./index.css\";\n\nimport App from \"./components/App\";\nimport store from \"./reducers\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(\n  <Provider store={store}>\n    <Router>\n      <App />\n    </Router>\n  </Provider>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}