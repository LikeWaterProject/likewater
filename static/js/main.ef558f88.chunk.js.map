{"version":3,"sources":["components/LoadingPanel.js","datatypes/Coordinate.js","hooks/useLongPress.js","hooks/useEvents.js","assets/first-aid-kit-fill.svg","assets/broadcast-fill.svg","assets/alarm-warning-fill.svg","assets/fire-fill.svg","assets/lifebuoy-fill.svg","assets/pushpin-2-fill.svg","assets/focus-3-line.svg","components/Geolocator.js","components/MapControls.js","components/MapEventLayer.js","components/MapIcons.js","components/MapView.js","components/TopSheet.js","components/BottomSheet.js","components/App.js","reducers/eventsReducer.js","reducers/mapReducer.js","reducers/preferencesReducer.js","reducers/userReducer.js","reducers/index.js","serviceWorker.js","index.js","api/index.js","events/types.js","actions/types.js","actions/eventActions.js","actions/mapActions.js","actions/preferenceActions.js","actions/userActions.js"],"names":["LoadingPanel","inverted","raised","basic","style","padding","height","display","alignItems","active","inline","Coordinate","coords","Array","isArray","this","lon","lat","latitude","longitude","lng","from","to","distanceInMeters","getDistance","Math","round","preventDefault","event","isTouchEvent","touches","length","useLongPress","callback","isPreventDefault","delay","timeout","useRef","target","start","useCallback","map","originalEvent","addEventListener","passive","current","setTimeout","clear","clearTimeout","removeEventListener","onTouchStart","onTouchEnd","getEventIcon","eventCategory","EventType","icon","color","getSorter","sortBy","first","second","distance","lastConfirmDt","reportedDt","mapEvents","modelEvents","eventFilters","events","sort","filter","useEvents","useMemo","module","exports","connect","setCurrentPosition","location","useGeolocation","enableHighAccuracy","maximumAge","useEffect","isMounted","loading","state","shouldUseGeolocation","setUseGeolocation","context","currentPosition","flyTo","center","zoom","Button","title","position","top","right","onClick","rotateTo","Group","vertical","zoomIn","zoomOut","navigator","geolocation","getCurrentPosition","error","console","MapEventLayer","type","onMouseEvents","visibility","allowOverlap","id","layout","paint","evt","eventId","coordinates","key","properties","aidIcon","Image","src","aidAsset","infoIcon","infoAsset","policeIcon","policeAsset","safetyIcon","safetyAsset","sosIcon","sosAsset","pinIcon","pinAsset","positionIcon","positionAsset","MapIcons","data","Mapbox","ReactMapboxGl","accessToken","attributionControl","trackResize","MAP_DEFAULTS","defaultZoom","volumetricPainter","property","setMarkerPosition","onMoveEnd","toggleControls","history","useHistory","useWindowSize","width","defaultPosition","markerPosition","showVolumetricBuildings","nearbyEvents","showBasicMapFeatures","onItemHover","cursor","getCanvas","handleItemClick","feature","JSON","parse","push","onMouseEnter","onMouseLeave","handleAddMarker","mapEvent","isMoving","isRotating","isZooming","lngLat","onLongPressEvent","containerStyle","onStyleLoad","on","defaultPrevented","onContextMenu","sourceId","sourceLayer","minZoom","Consumer","isZoomedIn","getZoom","aid","info","police","safety","sos","toggleTheme","visible","useState","query","setQuery","Sidebar","as","Segment","direction","animation","textAlign","boxShadow","Menu","borderless","widths","Item","fitted","Search","disabled","value","onSearchChange","onFocus","onBlur","open","circular","size","floated","EventList","React","lazy","EventDetails","EventSubmit","preferences","invertedTheme","setMarkerAtMapPosition","withRouter","useLocation","Loader","className","compact","pathname","fallback","path","exact","initializeUser","initializeGeolocation","getEvents","getEventTypes","setMapPosition","controlsVisible","setControlsVisible","handleToggleControls","v","Pushable","Pusher","getCenter","getBounds","_sw","_ne","radius","distanceBetween","log","INITIAL_STATE","dangerClose","eventTypes","localStorage","getItem","SET_DEFAULT_POSITION","mapPosition","userToken","validUntil","rootReducer","combineReducers","payload","FETCH_EVENTS","FETCH_EVENT_TYPES","SET_EVENT_FILTER","SET_MARKER_POSITION","SET_CURRENT_POSITION","SET_MAP_POSITION","SET_USE_GEOLOCATION","TOGGLE_THEME","user","INITIALIZE_USER","INVALIDATE_USER","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","applyMiddleware","thunk","Boolean","hostname","match","ReactDOM","render","document","getElementById","serviceWorker","ready","then","registration","unregister","catch","message","API","axios","create","baseURL","AID","INFO","POLICE","SAFETY","EMERGENCY","PIN","POSITION","FETCH_EVENT_DETAILS","dispatch","a","post","result","get","reportEvent","eventType","eventDesc","getState","respondToEvent","eventActive","response","status","setEventFilter","filters","preferred","setItem","stringify","permissions","name","permissionStatus","permitted","onchange","Date","now","uuidv4","addDays","getTime"],"mappings":"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","file":"static/js/main.ef558f88.chunk.js","sourcesContent":["import React from \"react\";\r\nimport { Segment, Loader } from \"semantic-ui-react\";\r\n\r\nconst LoadingPanel = ({ inverted }) => (\r\n  <Segment raised basic inverted={inverted} style={{ padding: 8, height: 292 }}>\r\n    <div style={{ height: \"100%\", display: \"flex\", alignItems: \"center\" }}>\r\n      <Loader active inline=\"centered\" />\r\n    </div>\r\n  </Segment>\r\n);\r\n\r\nexport default LoadingPanel;\r\n","import { getDistance } from \"geolib\";\r\n\r\nconst FEET_PER_METER = 3.28084;\r\n\r\nexport default class Coordinate {\r\n  constructor(coords = {}) {\r\n    if (Array.isArray(coords)) {\r\n      [this.lon = 0, this.lat = 0] = coords;\r\n    } else {\r\n      const { latitude, lat = 0, longitude, lng, lon = 0 } = coords;\r\n      this.lon = longitude ?? lng ?? lon;\r\n      this.lat = latitude ?? lat;\r\n    }\r\n  }\r\n\r\n  static distanceBetween(from, to) {\r\n    const distanceInMeters = getDistance(from, to, 1);\r\n    return Math.round(distanceInMeters * FEET_PER_METER);\r\n  }\r\n\r\n  asArray() {\r\n    return [this.lon, this.lat];\r\n  }\r\n\r\n  asObject() {\r\n    return { lon: this.lon, lat: this.lat };\r\n  }\r\n}\r\n","/* eslint-disable */\r\nimport { useCallback, useRef } from \"react\";\r\n\r\nconst isTouchEvent = (event) => {\r\n  return !!event[\"touches\"];\r\n};\r\n\r\nconst preventDefault = (event) => {\r\n  if (!isTouchEvent(event)) return;\r\n  if (event.touches.length > 1 && event.preventDefault) {\r\n    event.preventDefault && event.preventDefault();\r\n  }\r\n};\r\n\r\nexport const useLongPress = (\r\n  callback,\r\n  { isPreventDefault = true, delay = 500 } = {}\r\n) => {\r\n  const timeout = useRef();\r\n  const target = useRef();\r\n\r\n  const start = useCallback(\r\n    (map, event) => {\r\n      const { originalEvent } = event;\r\n      // prevent ghost click on mobile devices\r\n      if (isPreventDefault && originalEvent.target) {\r\n        originalEvent.target.addEventListener(\"touchend\", preventDefault, {\r\n          passive: false,\r\n        });\r\n        target.current = originalEvent.target;\r\n      }\r\n      if (originalEvent.touches.length < 2) {\r\n        timeout.current = setTimeout(() => {\r\n          callback(map, event);\r\n        }, delay);\r\n      }\r\n    },\r\n    [callback, delay]\r\n  );\r\n\r\n  const clear = useCallback((map, event) => {\r\n    // clearTimeout and removeEventListener\r\n    timeout.current && clearTimeout(timeout.current);\r\n    if (isPreventDefault && target.current) {\r\n      target.current.removeEventListener(\"touchend\", preventDefault);\r\n    }\r\n  }, []);\r\n\r\n  return {\r\n    // onMouseDown: start,\r\n    onTouchStart: start,\r\n    // onMouseUp: clear,\r\n    // onMouseLeave: clear,\r\n    onTouchEnd: clear,\r\n  };\r\n};\r\n","import { useMemo } from \"react\";\r\nimport * as EventType from \"../events/types\";\r\n\r\nconst getEventIcon = (eventCategory) => {\r\n  switch (eventCategory) {\r\n    case EventType.AID:\r\n      return { icon: \"first-aid-kit\", color: \"gainsboro\" };\r\n    case EventType.EMERGENCY:\r\n      return { icon: \"lifebuoy\", color: \"crimson\" };\r\n    case EventType.INFO:\r\n      return { icon: \"broadcast\", color: \"mediumseagreen\" };\r\n    case EventType.POLICE:\r\n      return { icon: \"alarm-warning\", color: \"royalblue\" };\r\n    case EventType.SAFETY:\r\n      return { icon: \"fire\", color: \"darkorange\" };\r\n    default:\r\n      return { icon: \"pushpin-2\", color: \"mediumpurple\" };\r\n  }\r\n};\r\n\r\nconst getSorter = (sortBy) => {\r\n  switch (sortBy) {\r\n    case \"distance\":\r\n      return (first, second) => first.distance - second.distance;\r\n    case \"time\":\r\n      return (first, second) =>\r\n        first.lastConfirmDt ??\r\n        first.reportedDt - second.lastConfirmDt ??\r\n        second.reportedDt;\r\n    case \"category\":\r\n      return (first, second) => first.eventCategory - second.eventCategory;\r\n    default:\r\n      return (first, second) => first.distance - second.distance;\r\n  }\r\n};\r\n\r\nexport const mapEvents = (\r\n  modelEvents = [],\r\n  eventFilters,\r\n  sortBy = \"distance\"\r\n) => {\r\n  const events = modelEvents.map((event) => {\r\n    return {\r\n      ...event,\r\n      ...getEventIcon(event.eventCategory),\r\n    };\r\n  });\r\n\r\n  sortBy && events.sort(getSorter(sortBy));\r\n\r\n  return eventFilters\r\n    ? events.filter((event) => !!eventFilters[event.eventCategory])\r\n    : events;\r\n};\r\n\r\nexport const useEvents = (modelEvents, eventFilters, sortBy) =>\r\n  useMemo(() => mapEvents(modelEvents, eventFilters, sortBy), [\r\n    modelEvents,\r\n    eventFilters,\r\n    sortBy,\r\n  ]);\r\n","module.exports = __webpack_public_path__ + \"static/media/first-aid-kit-fill.f96d703e.svg\";","module.exports = __webpack_public_path__ + \"static/media/broadcast-fill.d068d7ab.svg\";","module.exports = __webpack_public_path__ + \"static/media/alarm-warning-fill.129f3113.svg\";","module.exports = __webpack_public_path__ + \"static/media/fire-fill.feb2802d.svg\";","module.exports = __webpack_public_path__ + \"static/media/lifebuoy-fill.0b35b227.svg\";","module.exports = __webpack_public_path__ + \"static/media/pushpin-2-fill.466aaf39.svg\";","module.exports = __webpack_public_path__ + \"static/media/focus-3-line.ec68912f.svg\";","import { useEffect } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { useGeolocation } from \"react-use\";\r\n\r\nimport { setCurrentPosition } from \"../actions\";\r\n\r\nconst Geolocator = ({ setCurrentPosition }) => {\r\n  const location = useGeolocation({\r\n    enableHighAccuracy: true,\r\n    maximumAge: 30000,\r\n    timeout: 30000,\r\n  });\r\n\r\n  useEffect(() => {\r\n    let isMounted = true;\r\n    if (!location.loading && location.longitude && location.latitude) {\r\n      isMounted && setCurrentPosition(location);\r\n    }\r\n\r\n    return () => (isMounted = false);\r\n  }, [location, setCurrentPosition]);\r\n\r\n  return null;\r\n};\r\n\r\nexport default connect(null, { setCurrentPosition })(Geolocator);\r\n","import React, { useEffect } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Button } from \"semantic-ui-react\";\r\n\r\nimport { setUseGeolocation, setCurrentPosition } from \"../actions\";\r\n\r\nconst MapControls = ({\r\n  context,\r\n  inverted,\r\n  currentPosition,\r\n  shouldUseGeolocation,\r\n  setUseGeolocation,\r\n  setCurrentPosition,\r\n}) => {\r\n  useEffect(() => {\r\n    if (currentPosition && shouldUseGeolocation) {\r\n      context.flyTo({\r\n        center: [currentPosition.longitude, currentPosition.latitude],\r\n        zoom: 16,\r\n      });\r\n    }\r\n  }, [context, currentPosition, shouldUseGeolocation]);\r\n\r\n  const handleZoomIn = () => {\r\n    context.zoomIn();\r\n  };\r\n\r\n  const handleZoomOut = () => {\r\n    context.zoomOut();\r\n  };\r\n\r\n  const handleReorient = () => {\r\n    context.rotateTo(0);\r\n  };\r\n\r\n  const handleShouldUseGeolocation = () => {\r\n    setUseGeolocation(!shouldUseGeolocation);\r\n  };\r\n\r\n  const handleFocusPosition = () => {\r\n    navigator.geolocation.getCurrentPosition(\r\n      ({ coords }) => {\r\n        setCurrentPosition(coords);\r\n        context.flyTo({\r\n          center: [coords.longitude, coords.latitude],\r\n          zoom: 16,\r\n        });\r\n      },\r\n      (error) => {\r\n        console.error(error);\r\n        if (currentPosition) {\r\n          context.flyTo({\r\n            center: [currentPosition.longitude, currentPosition.latitude],\r\n            zoom: 16,\r\n          });\r\n        }\r\n      },\r\n      { maximumAge: 0, timeout: 3000 }\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <Button\r\n        title=\"Reorient map\"\r\n        icon=\"arrow up\"\r\n        color={inverted ? \"black\" : null}\r\n        style={{ position: \"absolute\", top: 98, right: 3 }}\r\n        onClick={handleReorient}\r\n      />\r\n      <Button.Group\r\n        vertical\r\n        style={{ position: \"absolute\", top: 142, right: 6 }}\r\n      >\r\n        <Button\r\n          title=\"Zoom in\"\r\n          color={inverted ? \"black\" : null}\r\n          icon=\"plus\"\r\n          onClick={handleZoomIn}\r\n        />\r\n        <Button\r\n          title=\"Zoom out\"\r\n          color={inverted ? \"black\" : null}\r\n          icon=\"minus\"\r\n          onClick={handleZoomOut}\r\n        />\r\n      </Button.Group>\r\n      <Button\r\n        title=\"Track my location\"\r\n        color={shouldUseGeolocation ? \"blue\" : inverted ? \"black\" : null}\r\n        icon=\"location arrow\"\r\n        style={{ position: \"absolute\", top: 222, right: 3 }}\r\n        onClick={handleShouldUseGeolocation}\r\n      />\r\n      <Button\r\n        title=\"Center map on my location\"\r\n        color={inverted ? \"black\" : null}\r\n        icon=\"crosshairs\"\r\n        style={{ position: \"absolute\", top: 266, right: 3 }}\r\n        onClick={handleFocusPosition}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n  return { shouldUseGeolocation: state.map.shouldUseGeolocation };\r\n};\r\n\r\nexport default connect(mapStateToProps, {\r\n  setUseGeolocation,\r\n  setCurrentPosition,\r\n})(MapControls);\r\n","import React from \"react\";\r\nimport { Layer, Feature } from \"react-mapbox-gl\";\r\n\r\nimport * as EventType from \"../events/types\";\r\n\r\nconst MapEventLayer = ({\r\n  type = EventType.INFO,\r\n  events = [],\r\n  onMouseEvents,\r\n  visibility = true,\r\n  allowOverlap = false,\r\n}) => {\r\n  return (\r\n    <Layer\r\n      id={type}\r\n      type=\"symbol\"\r\n      layout={{\r\n        visibility: visibility ? \"visible\" : \"none\",\r\n        \"icon-image\": type,\r\n        \"icon-allow-overlap\": allowOverlap,\r\n        // \"icon-ignore-placement\": true,\r\n      }}\r\n      paint={{\r\n        \"icon-color\": \"red\",\r\n        \"icon-halo-blur\": 1,\r\n        \"icon-halo-width\": 40,\r\n        \"icon-halo-color\": \"#ff0000\",\r\n      }}\r\n    >\r\n      {events.map((evt) => {\r\n        const {\r\n          eventId,\r\n          coordinates: { lon, lat },\r\n        } = evt;\r\n        return (\r\n          <Feature\r\n            key={eventId}\r\n            coordinates={[lon, lat]}\r\n            properties={evt}\r\n            {...onMouseEvents}\r\n          />\r\n        );\r\n      })}\r\n    </Layer>\r\n  );\r\n};\r\n\r\nexport default MapEventLayer;\r\n","import React from \"react\";\r\nimport { Image as Pin } from \"react-mapbox-gl\";\r\n\r\nimport * as EventType from \"../events/types\";\r\n\r\nimport aidAsset from \"../assets/first-aid-kit-fill.svg\";\r\nimport infoAsset from \"../assets/broadcast-fill.svg\";\r\nimport policeAsset from \"../assets/alarm-warning-fill.svg\";\r\nimport safetyAsset from \"../assets/fire-fill.svg\";\r\nimport sosAsset from \"../assets/lifebuoy-fill.svg\";\r\nimport pinAsset from \"../assets/pushpin-2-fill.svg\";\r\nimport positionAsset from \"../assets/focus-3-line.svg\";\r\n\r\nconst aidIcon = new Image(24, 24);\r\naidIcon.src = aidAsset;\r\nconst infoIcon = new Image(24, 24);\r\ninfoIcon.src = infoAsset;\r\nconst policeIcon = new Image(24, 24);\r\npoliceIcon.src = policeAsset;\r\nconst safetyIcon = new Image(24, 24);\r\nsafetyIcon.src = safetyAsset;\r\nconst sosIcon = new Image(24, 24);\r\nsosIcon.src = sosAsset;\r\nconst pinIcon = new Image(24, 24);\r\npinIcon.src = pinAsset;\r\nconst positionIcon = new Image(24, 24);\r\npositionIcon.src = positionAsset;\r\n\r\nconst MapIcons = () => (\r\n  <>\r\n    <Pin id={EventType.AID} data={aidIcon} />\r\n    <Pin id={EventType.INFO} data={infoIcon} />\r\n    <Pin id={EventType.POLICE} data={policeIcon} />\r\n    <Pin id={EventType.SAFETY} data={safetyIcon} />\r\n    <Pin id={EventType.EMERGENCY} data={sosIcon} />\r\n    <Pin id={EventType.PIN} data={pinIcon} />\r\n    <Pin id={EventType.POSITION} data={positionIcon} />\r\n  </>\r\n);\r\n\r\nexport default MapIcons;\r\n","import React, { useRef, useMemo, useCallback } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { useWindowSize } from \"react-use\";\r\nimport ReactMapboxGl, { MapContext, Layer, Feature } from \"react-mapbox-gl\";\r\n\r\nimport * as EventType from \"../events/types\";\r\nimport { useLongPress } from \"../hooks\";\r\nimport { setMarkerPosition } from \"../actions\";\r\nimport MapControls from \"./MapControls\";\r\nimport MapEventLayer from \"./MapEventLayer\";\r\nimport MapIcons from \"./MapIcons\";\r\n\r\nconst Mapbox = ReactMapboxGl({\r\n  accessToken:\r\n    \"pk.eyJ1IjoicmVrdGRlY2thcmQiLCJhIjoiY2theWJ4OXM0MGhiejJ3cnkzcmk0andiYyJ9.IinlG0vyUvcWhvlAREJXeA\",\r\n  attributionControl: false,\r\n  trackResize: false,\r\n});\r\n\r\nconst MAP_DEFAULTS = {\r\n  defaultZoom: [10],\r\n  volumetricPainter: {\r\n    // \"fill-extrusion-color\": inverted ? \"#424D5C\" : \"#CAD2D3\",\r\n    \"fill-extrusion-height\": {\r\n      type: \"identity\",\r\n      property: \"height\",\r\n    },\r\n    \"fill-extrusion-base\": {\r\n      type: \"identity\",\r\n      property: \"min_height\",\r\n    },\r\n    \"fill-extrusion-opacity\": 0.6,\r\n  },\r\n};\r\n\r\nconst MapView = ({\r\n  map,\r\n  events,\r\n  onMoveEnd,\r\n  toggleControls,\r\n  setMarkerPosition,\r\n  inverted,\r\n}) => {\r\n  const history = useHistory();\r\n  const { width, height } = useWindowSize();\r\n  const defaultPosition = useRef(map.defaultPosition);\r\n  const {\r\n    currentPosition,\r\n    markerPosition,\r\n    showVolumetricBuildings,\r\n    showBasicMapFeatures,\r\n  } = map;\r\n  const { nearbyEvents, eventFilters } = events;\r\n\r\n  const initializeMap = (map) => {\r\n    map.on(\"click\", ({ originalEvent }) => {\r\n      if (!originalEvent.defaultPrevented) {\r\n        setMarkerPosition(null);\r\n        history.push(\"/\");\r\n      }\r\n    });\r\n  };\r\n\r\n  const onItemHover = ({ map }, cursor) => {\r\n    map.getCanvas().style.cursor = cursor;\r\n  };\r\n\r\n  const handleItemClick = useCallback(\r\n    ({\r\n      map,\r\n      feature: {\r\n        properties: { eventId, coordinates },\r\n      },\r\n      originalEvent,\r\n    }) => {\r\n      originalEvent.preventDefault();\r\n      const { lon, lat } = JSON.parse(coordinates);\r\n      map.flyTo({ center: [lon, lat], zoom: 16 });\r\n      toggleControls(true);\r\n      history.push(`/events/${eventId}`);\r\n    },\r\n    [history, toggleControls]\r\n  );\r\n\r\n  const onMouseEvents = useMemo(\r\n    () => ({\r\n      onMouseEnter: (event) => onItemHover(event, \"pointer\"),\r\n      onMouseLeave: (event) => onItemHover(event, \"\"),\r\n      onClick: handleItemClick,\r\n    }),\r\n    [handleItemClick]\r\n  );\r\n\r\n  const handleAddMarker = (map, mapEvent) => {\r\n    if (map.isMoving() || map.isRotating() || map.isZooming()) return;\r\n    const { lat, lng } = mapEvent.lngLat;\r\n    toggleControls(true);\r\n    setMarkerPosition([lng, lat]);\r\n    map.flyTo({ center: [lng, lat], zoom: 16 });\r\n    history.push(\"/submit\");\r\n  };\r\n\r\n  const onLongPressEvent = useLongPress(handleAddMarker, {\r\n    isPreventDefault: true,\r\n    delay: 500,\r\n  });\r\n\r\n  return (\r\n    <Mapbox\r\n      style={\r\n        inverted\r\n          ? \"mapbox://styles/rektdeckard/ckayd52rb0xzg1imcbyek0g4y\"\r\n          : \"mapbox://styles/mapbox/light-v10\"\r\n      }\r\n      containerStyle={{\r\n        width,\r\n        height,\r\n      }}\r\n      center={defaultPosition.current}\r\n      zoom={MAP_DEFAULTS.defaultZoom}\r\n      onStyleLoad={initializeMap}\r\n      onContextMenu={handleAddMarker}\r\n      onMoveEnd={onMoveEnd}\r\n      {...onLongPressEvent}\r\n    >\r\n      <MapIcons />\r\n\r\n      {showVolumetricBuildings && (\r\n        <Layer\r\n          id=\"3d-buildings\"\r\n          type=\"fill-extrusion\"\r\n          sourceId=\"composite\"\r\n          sourceLayer=\"building\"\r\n          filter={[\"==\", \"extrude\", \"true\"]}\r\n          minZoom={14}\r\n          paint={{\r\n            ...MAP_DEFAULTS.volumetricPainter,\r\n            \"fill-extrusion-color\": inverted ? \"#424D5C\" : \"#CAD2D3\",\r\n          }}\r\n        />\r\n      )}\r\n\r\n      {/* FIXME: context does not update unless props do, wherefore no repaint of icons */}\r\n      <MapContext.Consumer>\r\n        {(context) => {\r\n          const isZoomedIn = context.getZoom() > 15;\r\n          return (\r\n            <>\r\n              <MapControls context={context} currentPosition={currentPosition} inverted={inverted} />\r\n              {eventFilters[EventType.AID] && (\r\n                <MapEventLayer\r\n                  type={EventType.AID}\r\n                  events={nearbyEvents.filter(\r\n                    ({ eventCategory }) => eventCategory === EventType.AID\r\n                  )}\r\n                  onMouseEvents={onMouseEvents}\r\n                  visibility={eventFilters.aid}\r\n                  allowOverlap={isZoomedIn}\r\n                />\r\n              )}\r\n              {eventFilters[EventType.INFO] && (\r\n                <MapEventLayer\r\n                  type={EventType.INFO}\r\n                  events={nearbyEvents.filter(\r\n                    ({ eventCategory }) => eventCategory === EventType.INFO\r\n                  )}\r\n                  onMouseEvents={onMouseEvents}\r\n                  visibility={eventFilters.info}\r\n                  allowOverlap={isZoomedIn}\r\n                />\r\n              )}\r\n              {eventFilters[EventType.POLICE] && (\r\n                <MapEventLayer\r\n                  type={EventType.POLICE}\r\n                  events={nearbyEvents.filter(\r\n                    ({ eventCategory }) => eventCategory === EventType.POLICE\r\n                  )}\r\n                  onMouseEvents={onMouseEvents}\r\n                  visibility={eventFilters.police}\r\n                  allowOverlap={isZoomedIn}\r\n                />\r\n              )}\r\n              {eventFilters[EventType.SAFETY] && (\r\n                <MapEventLayer\r\n                  type={EventType.SAFETY}\r\n                  events={nearbyEvents.filter(\r\n                    ({ eventCategory }) => eventCategory === EventType.SAFETY\r\n                  )}\r\n                  onMouseEvents={onMouseEvents}\r\n                  visibility={eventFilters.safety}\r\n                  allowOverlap={isZoomedIn}\r\n                />\r\n              )}\r\n              {eventFilters[EventType.EMERGENCY] && (\r\n                <MapEventLayer\r\n                  type={EventType.EMERGENCY}\r\n                  events={nearbyEvents.filter(\r\n                    ({ eventCategory }) => eventCategory === EventType.EMERGENCY\r\n                  )}\r\n                  onMouseEvents={onMouseEvents}\r\n                  visibility={eventFilters.sos}\r\n                  allowOverlap={isZoomedIn}\r\n                />\r\n              )}\r\n            </>\r\n          );\r\n        }}\r\n      </MapContext.Consumer>\r\n\r\n      {markerPosition && (\r\n        <Layer\r\n          id=\"map-marker\"\r\n          type=\"symbol\"\r\n          layout={{\r\n            \"icon-image\": \"PIN\",\r\n            \"icon-anchor\": \"bottom\",\r\n            \"icon-allow-overlap\": true,\r\n          }}\r\n        >\r\n          <Feature coordinates={markerPosition} />\r\n        </Layer>\r\n      )}\r\n      {currentPosition && (\r\n        <Layer\r\n          id=\"location-marker\"\r\n          type=\"symbol\"\r\n          layout={{ \"icon-image\": \"POSITION\", \"icon-allow-overlap\": true }}\r\n        >\r\n          <Feature\r\n            coordinates={[currentPosition.longitude, currentPosition.latitude]}\r\n            properties={currentPosition}\r\n          />\r\n        </Layer>\r\n      )}\r\n    </Mapbox>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n  return { map: state.map, events: state.events };\r\n};\r\n\r\nexport default connect(mapStateToProps, { setMarkerPosition })(MapView);\r\n","import React, { useState } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  Segment,\r\n  Menu,\r\n  Dropdown,\r\n  Search,\r\n  Sidebar,\r\n  Button,\r\n} from \"semantic-ui-react\";\r\n\r\nimport { toggleTheme } from \"../actions\";\r\n\r\nconst TopSheet = ({ inverted, visible, toggleControls, toggleTheme }) => {\r\n  const [query, setQuery] = useState(\"\");\r\n\r\n  return (\r\n    <Sidebar\r\n      as={Segment}\r\n      basic={!inverted}\r\n      inverted={inverted}\r\n      raised\r\n      direction=\"top\"\r\n      animation=\"push\"\r\n      textAlign=\"center\"\r\n      visible\r\n      style={{ padding: 0, boxShadow: \"none\" }}\r\n    >\r\n      <Menu inverted={inverted} borderless widths={3}>\r\n        <Menu.Item> </Menu.Item>\r\n        <Menu.Item fitted>\r\n          <Search\r\n            disabled\r\n            value={query}\r\n            onSearchChange={(event, { value }) => setQuery(value)}\r\n            onFocus={() => toggleControls(false)}\r\n            onBlur={() => toggleControls(true)}\r\n            open={false}\r\n          />\r\n        </Menu.Item>\r\n        <Menu.Menu position=\"right\">\r\n          <Menu.Item>\r\n            <Button\r\n              circular\r\n              size=\"large\"\r\n              color={inverted ? \"black\" : null}\r\n              icon=\"setting\"\r\n              floated=\"right\"\r\n              onClick={toggleTheme}\r\n            />\r\n          </Menu.Item>\r\n          {/* <Dropdown item icon=\"setting\" simple inverted={inverted}>\r\n            <Dropdown.Menu>\r\n              <Dropdown.Item>Open</Dropdown.Item>\r\n              <Dropdown.Item>Save...</Dropdown.Item>\r\n              <Dropdown.Item>Edit Permissions</Dropdown.Item>\r\n              <Dropdown.Divider />\r\n              <Dropdown.Header>Export</Dropdown.Header>\r\n              <Dropdown.Item>Share</Dropdown.Item>\r\n            </Dropdown.Menu>\r\n          </Dropdown> */}\r\n        </Menu.Menu>\r\n      </Menu>\r\n    </Sidebar>\r\n  );\r\n};\r\n\r\nexport default connect(null, { toggleTheme })(TopSheet);\r\n","import React, { useMemo, Suspense } from \"react\";\r\nimport {\r\n  withRouter,\r\n  Switch,\r\n  Route,\r\n  useLocation,\r\n  useHistory,\r\n} from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport { Sidebar, Button } from \"semantic-ui-react\";\r\n\r\nimport { setMarkerPosition, setMarkerAtMapPosition } from \"../actions\";\r\nimport LoadingPanel from \"./LoadingPanel\";\r\n\r\nconst EventList = React.lazy(() => import(\"./EventList\"));\r\nconst EventDetails = React.lazy(() => import(\"./EventDetails\"));\r\nconst EventSubmit = React.lazy(() => import(\"./EventSubmit\"));\r\n\r\nconst BottomSheet = ({ setMarkerPosition, setMarkerAtMapPosition, inverted, visible }) => {\r\n  const location = useLocation();\r\n  const history = useHistory();\r\n  const Loader = useMemo(() => <LoadingPanel inverted={inverted} />, [\r\n    inverted,\r\n  ]);\r\n\r\n  const handleFabClick = () => {\r\n    if (location.pathname === \"/submit\") {\r\n      setMarkerPosition(null);\r\n      history.push(\"/\");\r\n    } else {\r\n      setMarkerAtMapPosition();\r\n      history.push(\"/submit\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Sidebar\r\n      className=\"no-overflow unclickable\"\r\n      animation=\"push\"\r\n      direction=\"bottom\"\r\n      visible={visible}\r\n      style={{ boxShadow: \"none\" }}\r\n    >\r\n      <div style={{ textAlign: \"right\" }}>\r\n        <Button\r\n          className=\"clickable\"\r\n          circular\r\n          compact\r\n          color={inverted ? \"black\" : null}\r\n          size=\"huge\"\r\n          icon={location.pathname === \"/submit\" ? \"close\" : \"thumbtack\"}\r\n          onClick={handleFabClick}\r\n        ></Button>\r\n      </div>\r\n      <Suspense fallback={Loader}>\r\n        <Switch>\r\n          <Route path=\"/events/:id\">\r\n            <EventDetails inverted={inverted} />\r\n          </Route>\r\n          <Route exact path=\"/submit\">\r\n            <EventSubmit inverted={inverted} />\r\n          </Route>\r\n          <Route exact path=\"/sos\">\r\n            <LoadingPanel inverted={inverted} />\r\n          </Route>\r\n          <Route>\r\n            <EventList inverted={inverted} />\r\n          </Route>\r\n        </Switch>\r\n      </Suspense>\r\n    </Sidebar>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n  return { inverted: state.preferences.invertedTheme };\r\n};\r\n\r\nexport default connect(mapStateToProps, { setMarkerPosition, setMarkerAtMapPosition })(\r\n  withRouter(BottomSheet)\r\n);\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Sidebar } from \"semantic-ui-react\";\r\n// import { getDistance } from \"geolib\";\r\n\r\nimport {\r\n  initializeUser,\r\n  initializeGeolocation,\r\n  getEvents,\r\n  getEventTypes,\r\n  setMapPosition,\r\n} from \"../actions\";\r\nimport Geolocator from \"./Geolocator\";\r\nimport MapView from \"./MapView\";\r\nimport TopSheet from \"./TopSheet\";\r\nimport BottomSheet from \"./BottomSheet\";\r\nimport Coordinate from \"../datatypes/Coordinate\";\r\n\r\nconst App = ({\r\n  initializeUser,\r\n  initializeGeolocation,\r\n  shouldUseGeolocation,\r\n  defaultPosition,\r\n  getEvents,\r\n  getEventTypes,\r\n  setMapPosition,\r\n  inverted,\r\n}) => {\r\n  const [controlsVisible, setControlsVisible] = useState(true);\r\n\r\n  // TODO: separate effects into separate function calls\r\n  useEffect(() => {\r\n    initializeUser();\r\n    initializeGeolocation();\r\n    getEventTypes();\r\n    getEvents({\r\n      coordinates: {\r\n        lon: defaultPosition[0],\r\n        lat: defaultPosition[1],\r\n      },\r\n    });\r\n  }, [\r\n    initializeUser,\r\n    initializeGeolocation,\r\n    getEvents,\r\n    getEventTypes,\r\n    defaultPosition,\r\n  ]);\r\n\r\n  const handleMapMoveEnd = (context) => {\r\n    const { lng, lat } = context.getCenter();\r\n    const { _sw, _ne } = context.getBounds();\r\n    // const meters = getDistance(_sw, _ne);\r\n    const radius = Coordinate.distanceBetween(_sw, _ne) / 2;\r\n    setMapPosition([lng, lat]);\r\n    getEvents({ coordinates: { lon: lng, lat }, radius });\r\n  };\r\n\r\n  const handleMapContextMenu = (mapEvent) => {\r\n    console.log(mapEvent);\r\n  };\r\n\r\n  const handleToggleControls = (visible) => {\r\n    if (typeof visible === \"boolean\") return setControlsVisible(visible);\r\n    setControlsVisible((v) => !v);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {shouldUseGeolocation && <Geolocator />}\r\n      <Sidebar.Pushable className=\"no-overflow\">\r\n        <TopSheet\r\n          inverted={inverted}\r\n          visible={controlsVisible}\r\n          toggleControls={handleToggleControls}\r\n        />\r\n        <BottomSheet inverted={inverted} visible={controlsVisible} />\r\n        <Sidebar.Pusher>\r\n          <MapView\r\n            inverted={inverted}\r\n            toggleControls={handleToggleControls}\r\n            onMoveEnd={handleMapMoveEnd}\r\n            onContextMenu={handleMapContextMenu}\r\n          />\r\n        </Sidebar.Pusher>\r\n      </Sidebar.Pushable>\r\n    </>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    shouldUseGeolocation: state.map.shouldUseGeolocation,\r\n    defaultPosition: state.map.defaultPosition,\r\n    inverted: state.preferences.invertedTheme,\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps, {\r\n  initializeUser,\r\n  initializeGeolocation,\r\n  getEvents,\r\n  getEventTypes,\r\n  setMapPosition,\r\n})(App);\r\n","import {\r\n  FETCH_EVENTS,\r\n  FETCH_EVENT_TYPES,\r\n  SET_EVENT_FILTER,\r\n  UPDATE_EVENT,\r\n} from \"../actions\";\r\nimport * as EventType from \"../events/types\";\r\n\r\nconst INITIAL_STATE = {\r\n  dangerClose: false,\r\n  nearbyEvents: [],\r\n  eventTypes: null,\r\n  eventFilters: {\r\n    [EventType.AID]: true,\r\n    [EventType.INFO]: true,\r\n    [EventType.POLICE]: true,\r\n    [EventType.SAFETY]: true,\r\n    [EventType.EMERGENCY]: true,\r\n  },\r\n};\r\n\r\nexport default (state = INITIAL_STATE, { type, payload }) => {\r\n  switch (type) {\r\n    case FETCH_EVENTS:\r\n      return {\r\n        ...state,\r\n        nearbyEvents: payload,\r\n      };\r\n    case FETCH_EVENT_TYPES:\r\n      return {\r\n        ...state,\r\n        eventTypes: payload,\r\n      };\r\n    case SET_EVENT_FILTER:\r\n      return {\r\n        ...state,\r\n        eventFilters: {\r\n          ...state.eventFilters,\r\n          ...payload,\r\n        },\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import {\r\n  SET_DEFAULT_POSITION,\r\n  SET_CURRENT_POSITION,\r\n  SET_MARKER_POSITION,\r\n  SET_MAP_POSITION,\r\n  SET_USE_GEOLOCATION,\r\n} from \"../actions\";\r\n\r\nconst defaultPosition = JSON.parse(localStorage.getItem(SET_DEFAULT_POSITION)) ?? [\r\n  -74.0,\r\n  40.73,\r\n];\r\n\r\nconst INITIAL_STATE = {\r\n  markerPosition: null,\r\n  currentPosition: null,\r\n  defaultPosition: defaultPosition,\r\n  mapPosition: defaultPosition,\r\n  shouldUseGeolocation: false,\r\n  showBasicMapFeatures: true,\r\n  showVolumetricBuildings: true,\r\n};\r\n\r\nexport default (state = INITIAL_STATE, { type, payload }) => {\r\n  switch (type) {\r\n    case SET_MARKER_POSITION:\r\n      return {\r\n        ...state,\r\n        markerPosition: payload,\r\n      };\r\n    case SET_CURRENT_POSITION:\r\n      return {\r\n        ...state,\r\n        currentPosition: payload,\r\n      };\r\n    case SET_MAP_POSITION:\r\n      return {\r\n        ...state,\r\n        mapPosition: payload,\r\n      }\r\n    case SET_DEFAULT_POSITION:\r\n      return {\r\n        ...state,\r\n        defaultPosition: payload,\r\n      };\r\n    case SET_USE_GEOLOCATION:\r\n      return {\r\n        ...state,\r\n        shouldUseGeolocation: payload,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { TOGGLE_THEME } from \"../actions\";\r\n\r\nconst INITIAL_STATE = {\r\n  invertedTheme: true,\r\n};\r\n\r\nexport default (state = INITIAL_STATE, { type, payload }) => {\r\n  switch (type) {\r\n    case TOGGLE_THEME:\r\n      return {\r\n        ...state,\r\n        invertedTheme: !state.invertedTheme,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { INITIALIZE_USER, INVALIDATE_USER } from \"../actions\";\r\n\r\nconst INITIAL_STATE = {\r\n  userToken: null,\r\n  validUntil: null,\r\n};\r\n\r\nexport default (state = INITIAL_STATE, { type, payload }) => {\r\n  switch (type) {\r\n    case INITIALIZE_USER:\r\n      return payload;\r\n    case INVALIDATE_USER:\r\n      return INITIAL_STATE;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { combineReducers, createStore, applyMiddleware, compose } from \"redux\";\r\nimport thunk from \"redux-thunk\";\r\n\r\nimport eventsReducer from \"./eventsReducer\";\r\nimport mapReducer from \"./mapReducer\";\r\nimport preferencesReducer from \"./preferencesReducer\";\r\nimport userReducer from \"./userReducer\";\r\n\r\nconst rootReducer = combineReducers({\r\n  events: eventsReducer,\r\n  map: mapReducer,\r\n  preferences: preferencesReducer,\r\n  user: userReducer,\r\n});\r\n\r\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\nconst store = createStore(\r\n  rootReducer,\r\n  {},\r\n  composeEnhancers(applyMiddleware(thunk))\r\n);\r\n\r\nexport default store;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { Provider } from \"react-redux\";\r\nimport { BrowserRouter as Router } from \"react-router-dom\";\r\nimport \"semantic-ui-css/semantic.min.css\";\r\nimport \"remixicon/fonts/remixicon.css\";\r\nimport \"./index.css\";\r\n\r\nimport App from \"./components/App\";\r\nimport store from \"./reducers\";\r\nimport * as serviceWorker from \"./serviceWorker\";\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <Router>\r\n      <App />\r\n    </Router>\r\n  </Provider>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","import axios from \"axios\";\r\n\r\nconst API = axios.create({\r\n  baseURL: \"https://likewater-internal.azurewebsites.net/api\",\r\n});\r\n\r\nexport default API;\r\n","export const AID = \"AID\";\r\nexport const INFO = \"INFO\";\r\nexport const POLICE = \"POLICE\";\r\nexport const SAFETY = \"SAFETY\";\r\nexport const EMERGENCY = \"SOS\";\r\nexport const PIN = \"PIN\";\r\nexport const POSITION = \"POSITION\";","export const FETCH_EVENTS = \"fetch_events\";\r\nexport const FETCH_EVENT_TYPES = \"fetch_event_types\";\r\nexport const FETCH_EVENT_DETAILS = \"fetch_event_details\";\r\nexport const UPDATE_EVENT = \"update_event\";\r\nexport const SET_EVENT_FILTER = \"update_event_filter\";\r\n\r\nexport const SET_DEFAULT_POSITION = \"update_default_position\";\r\nexport const SET_CURRENT_POSITION = \"set_current_position\";\r\nexport const SET_MARKER_POSITION = \"set_marker_position\";\r\nexport const SET_MAP_POSITION = \"set_map_center\";\r\nexport const SET_USE_GEOLOCATION = \"set_use_geolocation\";\r\n\r\nexport const INITIALIZE_USER = \"initialize_user\";\r\nexport const INVALIDATE_USER = \"invalidate_user\";\r\n\r\nexport const TOGGLE_THEME = \"toggle_theme\";\r\n","import {\r\n  FETCH_EVENTS,\r\n  FETCH_EVENT_TYPES,\r\n  FETCH_EVENT_DETAILS,\r\n  SET_EVENT_FILTER,\r\n} from \".\";\r\nimport API from \"../api\";\r\n\r\nexport const getEvents = ({\r\n  coordinates,\r\n  radius = 75000,\r\n  userToken = \"UNASSIGNED\",\r\n}) => async (dispatch) => {\r\n  const result = await API.post(\"/getevents\", {\r\n    coordinates,\r\n    radius,\r\n    userToken,\r\n  });\r\n  dispatch({\r\n    type: FETCH_EVENTS,\r\n    payload: result.data,\r\n  });\r\n};\r\n\r\nexport const getEventTypes = () => async (dispatch) => {\r\n  const result = await API.get(\"/geteventtypes\");\r\n  dispatch({\r\n    type: FETCH_EVENT_TYPES,\r\n    payload: result.data,\r\n  });\r\n};\r\n\r\nexport const getEventDetails = (eventId) => async (dispatch) => {\r\n  const result = await API.post(\"/vieweventdetails\", eventId);\r\n  dispatch({\r\n    type: FETCH_EVENT_DETAILS,\r\n    payload: result.data,\r\n  });\r\n};\r\n\r\nexport const reportEvent = ({\r\n  coordinates,\r\n  eventCategory,\r\n  eventType,\r\n  eventDesc,\r\n}) => async (dispatch, getState) => {\r\n  const userToken = getState().user.userToken ?? \"UNASSIGNED\";\r\n  const result = await API.post(\"/reportevent\", {\r\n    coordinates,\r\n    eventCategory,\r\n    eventType,\r\n    eventDesc,\r\n    userToken,\r\n  });\r\n  dispatch(getEvents({ coordinates, userToken }));\r\n};\r\n\r\nexport const respondToEvent = ({ eventId, eventActive }) => async (\r\n  dispatch,\r\n  getState\r\n) => {\r\n  const userToken = getState().user.userToken ?? \"UNASSIGNED\";\r\n  const response = await API.post(\"/respondtoevent\", {\r\n    eventId,\r\n    eventActive,\r\n    userToken,\r\n  });\r\n  console.log(response);\r\n  if (response.status === 200) {\r\n    // Mark event as confirmed/denied for this user\r\n  }\r\n};\r\n\r\nexport const setEventFilter = (filters = {}) => {\r\n  return {\r\n    type: SET_EVENT_FILTER,\r\n    payload: filters,\r\n  };\r\n};\r\n","import {\r\n  SET_CURRENT_POSITION,\r\n  SET_USE_GEOLOCATION,\r\n  SET_DEFAULT_POSITION,\r\n  SET_MARKER_POSITION,\r\n  SET_MAP_POSITION,\r\n} from \"./types\";\r\n\r\nexport const setMarkerPosition = (coordinates) => {\r\n  return {\r\n    type: SET_MARKER_POSITION,\r\n    payload: coordinates,\r\n  };\r\n};\r\n\r\nexport const setMarkerAtMapPosition = () => (dispatch, getState) => {\r\n  dispatch({\r\n    type: SET_MARKER_POSITION,\r\n    payload: getState().map.mapPosition,\r\n  });\r\n};\r\n\r\nexport const setDefaultPosition = (coordinates) => {\r\n  localStorage.setItem(SET_DEFAULT_POSITION, JSON.stringify(coordinates));\r\n  return {\r\n    type: SET_DEFAULT_POSITION,\r\n    payload: coordinates,\r\n  };\r\n};\r\n\r\nexport const setCurrentPosition = (position) => {\r\n  return {\r\n    type: SET_CURRENT_POSITION,\r\n    payload: position,\r\n  };\r\n};\r\n\r\nexport const setMapPosition = (position) => {\r\n  return {\r\n    type: SET_MAP_POSITION,\r\n    payload: position,\r\n  };\r\n};\r\n\r\nexport const setUseGeolocation = (preferred) => async (dispatch) => {\r\n  localStorage.setItem(SET_USE_GEOLOCATION, JSON.stringify(!!preferred));\r\n  const { state: permitted } = await navigator.permissions.query({\r\n    name: \"geolocation\",\r\n  });\r\n\r\n  dispatch({\r\n    type: SET_USE_GEOLOCATION,\r\n    payload: !!preferred,\r\n  });\r\n\r\n  if (!preferred) dispatch(setCurrentPosition(null));\r\n};\r\n\r\nexport const initializeGeolocation = () => async (dispatch, getState) => {\r\n  const preferred = JSON.parse(localStorage.getItem(SET_USE_GEOLOCATION));\r\n\r\n  let permitted;\r\n  navigator.permissions\r\n    .query({ name: \"geolocation\" })\r\n    .then((permissionStatus) => {\r\n      permitted = permissionStatus.state;\r\n      permissionStatus.onchange = ({ target: { state: permitted } }) => {\r\n        dispatch({\r\n          type: SET_USE_GEOLOCATION,\r\n          payload:\r\n            getState().map.shouldUseGeolocation && permitted === \"granted\",\r\n        });\r\n      };\r\n    });\r\n\r\n  dispatch({\r\n    type: SET_USE_GEOLOCATION,\r\n    payload: preferred && permitted === \"granted\",\r\n  });\r\n};\r\n","import { TOGGLE_THEME } from \"./types\";\r\n\r\nexport const toggleTheme = () => ({ type: TOGGLE_THEME });\r\n","import { INITIALIZE_USER, INVALIDATE_USER } from \"./types\";\r\nimport { v4 as uuidv4 } from \"uuid\";\r\nimport { addDays } from \"date-fns\";\r\n\r\nexport const initializeUser = () => {\r\n  let { userToken, validUntil } =\r\n    JSON.parse(localStorage.getItem(INITIALIZE_USER)) ?? {};\r\n  if (!userToken || !validUntil || Date.now() > validUntil) {\r\n    userToken = uuidv4();\r\n    validUntil = addDays(Date.now(), 1).getTime();\r\n    localStorage.setItem(\r\n      INITIALIZE_USER,\r\n      JSON.stringify({ userToken, validUntil })\r\n    );\r\n  }\r\n  return { type: INITIALIZE_USER, payload: { userToken, validUntil } };\r\n};\r\n\r\nexport const invalidateUser = () => {\r\n  localStorage.removeItem(INITIALIZE_USER);\r\n  return { type: INVALIDATE_USER };\r\n};\r\n"],"sourceRoot":""}