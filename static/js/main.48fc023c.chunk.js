(this.webpackJsonplikewater=this.webpackJsonplikewater||[]).push([[1],{113:function(e,t,n){"use strict";var o=n(0),a=n.n(o),r=n(374),i=n(373);t.a=function(){return a.a.createElement(r.a,{raised:!0,inverted:!0,style:{padding:8,height:292}},a.a.createElement("div",{style:{height:"100%",display:"flex",alignItems:"center"}},a.a.createElement(i.a,{active:!0,inline:"centered"})))}},120:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));var o=n(0),a=function(e){(function(e){return!!e.touches})(e)&&(console.log("useLongPress: preventing default"),e.touches.length<2&&e.preventDefault&&e.preventDefault&&e.preventDefault())},r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.isPreventDefault,r=void 0===n||n,i=t.delay,c=void 0===i?500:i,l=Object(o.useRef)(),s=Object(o.useRef)(),u=Object(o.useCallback)((function(t,n){var o,i=n.originalEvent;r&&i.target&&(i.target.addEventListener("touchend",a,{passive:!0}),s.current=i.target),(null===i||void 0===i||null===(o=i.touches)||void 0===o?void 0:o.length)<2&&(l.current=setTimeout((function(){e(t,n)}),c))}),[e,c]),d=Object(o.useCallback)((function(e,t){l.current&&clearTimeout(l.current),r&&s.current&&s.current.removeEventListener("touchend",a)}),[]);return{onTouchStart:u,onTouchEnd:d}},i=n(19),c=function(e){return e.map((function(e){var t=e.eventId,n=e.eventType,o=e.eventDesc,a=e.coordinates,r=e.reportedDt;return Object(i.a)({eventId:t,eventType:n,coordinates:a,eventDesc:o,reportedDt:r},function(e){switch(e){case"aid":return{icon:"first-aid-kit",color:"gainsboro"};case"emergency":return{icon:"lifebuoy",color:"crimson"};case"info":return{icon:"broadcast",color:"mediumseagreen"};case"police":return{icon:"alarm-warning",color:"royalblue"};case"safety":return{icon:"fire",color:"darkorange"};default:return{icon:"pushpin-2",color:"mediumpurple"}}}(n))}))},l=function(e){return Object(o.useMemo)((function(){return c(e)}),[e])}},182:function(e,t,n){e.exports=n.p+"static/media/pushpin-2-fill.466aaf39.svg"},183:function(e,t,n){e.exports=n.p+"static/media/alarm-warning-fill.129f3113.svg"},184:function(e,t,n){e.exports=n.p+"static/media/fire-fill.feb2802d.svg"},185:function(e,t,n){e.exports=n.p+"static/media/first-aid-kit-fill.f96d703e.svg"},186:function(e,t,n){e.exports=n.p+"static/media/broadcast-fill.d068d7ab.svg"},187:function(e,t,n){e.exports=n.p+"static/media/focus-3-line.ec68912f.svg"},209:function(e,t,n){e.exports=n(372)},220:function(e,t,n){},372:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),r=n(30),i=n.n(r),c=n(32),l=n(64),s=(n(218),n(219),n(220),n(50)),u=n(386),d=n(27),m=n.n(d),p=n(41),f=(n(81),function(e){return{type:"set_current_position",payload:e}}),v=n(382),g=Object(c.b)(null,{setCurrentPosition:f})((function(e){var t=e.setCurrentPosition,n=Object(v.a)({enableHighAccuracy:!0,maximumAge:15e3,timeout:3e4});return Object(o.useEffect)((function(){console.log("GEOLOCATOR: update position"),!n.loading&&n.longitude&&t(n)}),[n]),null})),b=n(15),h=n(385),E=n(20),y=n(120),O=n(182),k=n.n(O),j=n(183),w=n.n(j),_=n(184),C=n.n(_),x=n(185),D=n.n(x),I=n(186),P=n.n(I),S=n(187),T=n.n(S),A=n(387),U=Object(c.b)((function(e){return{shouldUseGeolocation:e.map.shouldUseGeolocation}}),{setUseGeolocation:function(e){return function(){var t=Object(p.a)(m.a.mark((function t(n){var o,a;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return localStorage.setItem("set_use_geolocation",JSON.stringify(e)),t.next=3,navigator.permissions.query({name:"geolocation"});case 3:o=t.sent,a=o.state,console.log("prefer geolocation: ",e),console.log("permit geolocation: ",a),n({type:"set_use_geolocation",payload:e}),e||n(f(null));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}})((function(e){var t=e.context,n=e.shouldUseGeolocation,o=e.setUseGeolocation;return a.a.createElement("div",null,a.a.createElement(A.a,{icon:"location arrow",color:"black",style:{position:"absolute",top:108,right:3},onClick:function(){t.rotateTo(0)}}),a.a.createElement(A.a.Group,{vertical:!0,style:{position:"absolute",top:152,right:6}},a.a.createElement(A.a,{color:"black",icon:"plus",onClick:function(){t.zoomIn()}}),a.a.createElement(A.a,{color:"black",icon:"minus",onClick:function(){t.zoomOut()}})),a.a.createElement(A.a,{color:n?"blue":"black",icon:"crosshairs",style:{position:"absolute",top:232,right:3},onClick:function(){o(!n)}}))})),G=Object(E.e)({accessToken:"pk.eyJ1IjoicmVrdGRlY2thcmQiLCJhIjoiY2theWJ4OXM0MGhiejJ3cnkzcmk0andiYyJ9.IinlG0vyUvcWhvlAREJXeA",attributionControl:!1}),M=new Image(24,24);M.src=k.a;var B=new Image(24,24);B.src=w.a;var F=new Image(24,24);F.src=C.a;var z=new Image(24,24);z.src=D.a;var L=new Image(24,24);L.src=P.a;var J=new Image(24,24);J.src=T.a;var R,N={defaultZoom:[10],volumetricPainter:{"fill-extrusion-color":"#424d5c","fill-extrusion-height":{type:"identity",property:"height"},"fill-extrusion-base":{type:"identity",property:"min_height"},"fill-extrusion-opacity":.6}},W=[{eventId:"0B479F98-12D1-49C5-9A5A-28E8BAC9E420",eventType:"police",eventDesc:"Beating at 12th and Lexington",userToken:"User98765",reportedDt:1592356915877,confirms:3,dismisses:1,coordinates:{lat:41,lon:-74}},{eventId:"0FF83A5F-EA8F-462C-AD8E-81BB704ED4FC",eventType:"aid",eventDesc:"Water bottles and eye-wash station",userToken:"User1111",reportedDt:1592430145773,confirms:0,dismisses:0,coordinates:{lat:40.6911,lon:-74.00348}},{eventId:"582276B6-65C8-4FAE-B7D6-27CD1F9EB19D",eventType:"info",userToken:"User1111",eventDesc:"Rally Point",reportedDt:1592356992014,confirms:3,dismisses:1,coordinates:{lat:40.695103,lon:-73.984165}},{eventId:"04E9E828-EFF3-4144-A875-39AC87179B66",eventType:"info",userToken:"User123456",eventDesc:"Extra Masks",reportedDt:1592430500012,confirms:3,dismisses:1,coordinates:{lat:40.694794,lon:-73.981783}},{eventId:"F176598B-A4E1-4E14-A3A3-6C0E2AAED664",eventType:"safety",userToken:"User123456",eventDesc:"Looting",reportedDt:1592430500012,confirms:2,dismisses:0,coordinates:{lat:40.693257,lon:-73.983478}}],V=Object(c.b)((function(e){return{map:e.map}}),{setMarkerPosition:function(e){return{type:"set_marker_position",payload:e}}})((function(e){e.onMoveEnd;var t=e.toggleControls,n=e.map,r=e.setMarkerPosition,i=Object(b.f)(),c=Object(h.a)(),l=c.width,s=c.height,u=n.currentPosition,d=n.defaultPosition,m=n.markerPosition,p=n.showVolumetricBuildings,f=(n.showBasicMapFeatures,function(e,t){e.map.getCanvas().style.cursor=t}),v=Object(o.useCallback)((function(e){var n=e.map,o=e.feature.properties,a=o.eventId,r=o.coordinates;e.originalEvent.preventDefault();var c=JSON.parse(r),l=c.lon,s=c.lat;n.flyTo({center:[l,s],zoom:16}),t(!0),i.push("/events/".concat(a))}),[i,t]),g=Object(o.useMemo)((function(){return{onMouseEnter:function(e){return f(e,"pointer")},onMouseLeave:function(e){return f(e,"")},onClick:v}}),[v]),O=function(e,n){if(!(e.isMoving()||e.isRotating()||e.isZooming())){var o=n.lngLat,a=o.lat,c=o.lng;t(!0),r([c,a]),e.flyTo({center:[c,a],zoom:16}),i.push("/submit")}},k=Object(y.c)(O,{isPreventDefault:!0,delay:500});return a.a.createElement(G,Object.assign({style:"mapbox://styles/rektdeckard/ckayd52rb0xzg1imcbyek0g4y",center:u?[u.longitude,u.latitude]:d,zoom:N.defaultZoom,containerStyle:{width:l,height:s},onStyleLoad:function(e){e.on("click",(function(e){e.originalEvent.defaultPrevented||(r(null),i.push("/"))}))},onContextMenu:O},k),a.a.createElement(E.b,{id:"police",data:B}),a.a.createElement(E.b,{id:"pin",data:M}),a.a.createElement(E.b,{id:"fire",data:F}),a.a.createElement(E.b,{id:"medical",data:z}),a.a.createElement(E.b,{id:"info",data:L}),a.a.createElement(E.b,{id:"position",data:J}),a.a.createElement(E.d.Consumer,null,(function(e){return a.a.createElement(U,{context:e})})),p&&a.a.createElement(E.c,{id:"3d-buildings",type:"fill-extrusion",sourceId:"composite",sourceLayer:"building",filter:["==","extrude","true"],minZoom:14,paint:N.volumetricPainter}),m&&a.a.createElement(E.c,{id:"map-marker",type:"symbol",layout:{"icon-image":"pin","icon-anchor":"bottom","icon-allow-overlap":!0}},a.a.createElement(E.a,{coordinates:m})),a.a.createElement(E.c,{id:"event-markers",type:"symbol",layout:{"icon-image":"info","icon-allow-overlap":!0}},W.map((function(e){var t=e.eventId,n=e.coordinates,o=n.lon,r=n.lat;return a.a.createElement(E.a,Object.assign({key:t,coordinates:[o,r],properties:e},g))}))),u&&a.a.createElement(E.c,{id:"location-marker",type:"symbol",layout:{"icon-image":"position","icon-allow-overlap":!0}},a.a.createElement(E.a,{coordinates:[u.longitude,u.latitude],properties:u})))})),X=n(374),Z=n(384),Y=function(e){var t=e.visible,n=Object(o.useState)(""),r=Object(s.a)(n,2),i=r[0],c=r[1];return a.a.createElement(u.a,{as:X.a,inverted:!0,raised:!0,direction:"top",animation:"push",textAlign:"center",visible:t},a.a.createElement(Z.a,{value:i,onSearchChange:function(e,t){var n=t.value;return c(n)},open:!1}))},q=n(113),H=a.a.createElement(q.a,null),Q=a.a.lazy((function(){return Promise.all([n.e(0),n.e(4),n.e(7)]).then(n.bind(null,433))})),$=a.a.lazy((function(){return Promise.all([n.e(0),n.e(6)]).then(n.bind(null,435))})),K=a.a.lazy((function(){return n.e(5).then(n.bind(null,437))})),ee=Object(b.h)((function(e){var t=e.visible;return a.a.createElement(u.a,{className:"no-overflow",animation:"push",direction:"bottom",visible:t,style:{boxShadow:"none"}},a.a.createElement("div",{style:{textAlign:"right"}},a.a.createElement(A.a,{circular:!0,compact:!0,color:"black",size:"huge",icon:"bullhorn",onClick:function(){return window.confirm("Send SOS?")}})),a.a.createElement(b.c,null,a.a.createElement(b.a,{path:"/events/:id"},a.a.createElement(o.Suspense,{fallback:H},a.a.createElement($,null))),a.a.createElement(b.a,{exact:!0,path:"/submit"},a.a.createElement(o.Suspense,{fallback:H},a.a.createElement(K,null))),a.a.createElement(b.a,{exact:!0,path:"/sos"},a.a.createElement(q.a,null)),a.a.createElement(b.a,null,a.a.createElement(o.Suspense,{fallback:H},a.a.createElement(Q,null)))))})),te=Object(c.b)((function(e){return{shouldUseGeolocation:e.map.shouldUseGeolocation}}),{initializeGeolocation:function(){return function(){var e=Object(p.a)(m.a.mark((function e(t,n){var o,a,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=null!==(o=JSON.parse(localStorage.getItem("set_use_geolocation")))&&void 0!==o&&o,navigator.permissions.query({name:"geolocation"}).then((function(e){r=e.state,e.onchange=function(e){var o=e.target.state;console.log("permission changed: ",o),t({type:"set_use_geolocation",payload:n().map.shouldUseGeolocation&&"granted"===o})}})),console.log("prefer geolocation: ",a),console.log("permit geolocation: ",r),t({type:"set_use_geolocation",payload:a&&"granted"===r});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}})((function(e){var t=e.shouldUseGeolocation,n=e.initializeGeolocation,r=Object(o.useState)(!0),i=Object(s.a)(r,2),c=i[0],l=i[1];Object(o.useEffect)((function(){n()}),[]);return a.a.createElement(a.a.Fragment,null,t&&a.a.createElement(g,null),a.a.createElement(u.a.Pushable,{className:"no-overflow"},a.a.createElement(Y,{visible:c}),a.a.createElement(ee,{visible:c}),a.a.createElement(u.a.Pusher,null,a.a.createElement(V,{onMoveEnd:function(e){var t=e.getCenter();t.lng,t.lat},toggleControls:function(e){if("boolean"===typeof e)return l(e);l((function(e){return!e}))},onContextMenu:function(e){console.log(e)}}))))})),ne=n(43),oe=n(198),ae=n(19),re={dangerClose:!1,nearbyEvents:[],eventFilter:[]},ie={markerPosition:null,currentPosition:null,defaultPosition:null!==(R=JSON.parse(localStorage.getItem("update_default_position")))&&void 0!==R?R:[-74,40.73],shouldUseGeolocation:!1,showBasicMapFeatures:!0,showVolumetricBuildings:!0},ce=Object(ne.c)({events:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0,n=t.type,o=t.payload;switch(n){case"fetch_events":return Object(ae.a)(Object(ae.a)({},e),{},{nearbyEvents:o});case"update_event_filter":return Object(ae.a)(Object(ae.a)({},e),{},{eventFilter:o});default:return e}},map:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0,n=t.type,o=t.payload;switch(n){case"set_marker_position":return Object(ae.a)(Object(ae.a)({},e),{},{markerPosition:o});case"set_current_position":return Object(ae.a)(Object(ae.a)({},e),{},{currentPosition:o});case"update_default_position":return Object(ae.a)(Object(ae.a)({},e),{},{defaultPosition:o});case"set_use_geolocation":return Object(ae.a)(Object(ae.a)({},e),{},{shouldUseGeolocation:o});default:return e}}}),le=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||ne.d,se=Object(ne.e)(ce,{},le(Object(ne.a)(oe.a)));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(c.a,{store:se},a.a.createElement(l.a,null,a.a.createElement(te,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},81:function(e,t,n){"use strict";var o=n(181),a=n.n(o).a.create({baseURL:"https://likewater-internal.azurewebsites.net/api"});t.a=a}},[[209,2,3]]]);
//# sourceMappingURL=main.48fc023c.chunk.js.map